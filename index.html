<!doctype html> 
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Taiwan Pride ğŸŒˆï½œReservation Confirmationï½œ10/24 é€±äº”æ™šé¤åå–®</title>
  <style>
    :root{
      /* S2 é¢¨æ ¼è‰²ç›¤ */
      --bg:#0A0B0F; --card:#10131A; --muted:#9AA4AF; --fg:#F2F5F8; --border:#1f2430;
      --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
      --rainbow: linear-gradient(90deg,#ff5f6d,#ffc371,#9be15d,#00e3ae,#45aaf2,#9b59b6);
      --btn-grad: linear-gradient(90deg,#7dd3fc,#86efac);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Noto Sans TC","PingFang TC","Microsoft JhengHei",ui-sans-serif,system-ui;
      background: radial-gradient(800px 600px at 10% -10%, rgba(255,255,255,.06), transparent), var(--bg);
      color:var(--fg);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:980px;margin:28px auto 64px;padding:0 14px}

    /* ===== æ¨™é¡Œä¸‰è¡Œï¼ˆç™½å­—ï¼‹å…‰æšˆï¼‰ ===== */
    .tl .t1,.tl .t2,.tl .t3{color:#fff;text-shadow:0 0 8px rgba(255,255,255,.28),0 0 18px rgba(255,255,255,.12)}
    .tl .t1{font-size:28px;font-weight:900;line-height:1.15}
    .tl .t2{font-size:22px;font-weight:800;opacity:.95}
    .tl .t3{font-size:16px;font-weight:700;opacity:.9}

    /* === å‡çµçª—æ ¼ï¼ˆå«ä¸‰è¡Œæ¨™é¡Œï¼‹å½©è™¹åº•ç·šï¼‹å³å´ RAKUï¼‰ === */
    .freeze-pane{
      position:sticky; top:0; z-index:90;
      background: linear-gradient(180deg, rgba(10,11,15,.85), rgba(10,11,15,.65));
      backdrop-filter: blur(4px);
    }
    .freeze-inner{max-width:980px;margin:0 auto;padding:10px 14px 6px} /* ä¸‹å…§è·å°å¹…å¢åŠ ä»¥å®¹ç´ç·Šè²¼å…§å®¹ */

    /* RAKU èˆ‡å½©è™¹åº•ç·šçš„æ‰¿è¼‰å®¹å™¨ï¼ˆè®“è²“å’ªååœ¨ç·šä¸Šï¼‰ */
    .raku-holder{position:relative}
    .raku-right{
      position:absolute; right:0;
      /* è®“åœ–ç‰‡çš„åº•ç·£å‰›å¥½ã€Œæ¥ã€åœ¨å½©è™¹ç·šä¸Šæ–¹ 2px è™•ï¼Œåƒååœ¨ç·šä¸Š */
      bottom: calc(2px + 6px); /* 2px å½©è™¹ç·šé«˜åº¦ + 6px ç·©è¡ */
      display:inline-grid; place-items:center;
    }

    .rainbow-line{height:2px;background:var(--rainbow);opacity:.6;border-radius:2px;margin:0 0 6px} /* èˆ‡ä¸‹æ–¹å…§å®¹æ›´è²¼è¿‘ */

    /* Leader æ¼¸å±¤å­— */
    .rbtext{
      background:var(--rainbow); -webkit-background-clip:text;background-clip:text; color:transparent;
      text-shadow:0 0 12px rgba(255,255,255,.08); font-weight:900; letter-spacing:.2px;
    }

    /* æœå°‹å¡ */
    .card{
      position:relative;border-radius:16px;padding:14px;border:1px solid rgba(255,255,255,.06);
      background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
      box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .row{display:grid;grid-template-columns:minmax(0,2fr) minmax(0,2fr) minmax(0,1fr);gap:8px;align-items:end}
    label{font-size:12px;color:var(--muted);margin-bottom:4px;display:block}
    .input-wrap{display:flex;flex-direction:column;min-width:0}
    input,button{width:100%;padding:11px 12px;border-radius:12px;border:1px solid var(--border);background:#0f1117;color:#0f1117;color:var(--fg);outline:none;font-size:14px}
    input::placeholder{color:#6b7280}

    /* å³ä¸Šæ–¹ï¼šå°è¦½ï¼åº§ä½åœ–é€£çµå€ï¼ˆåŒä¸€è¡Œã€é å³ï¼›åƒ…æ–‡å­—åˆ†è¡Œï¼‰ */
    .quick-links{display:flex;flex-direction:row;justify-content:flex-end;gap:14px;margin-bottom:0}
    .quick-links a{font-size:12px;line-height:1.15;opacity:.95;text-align:right}
    .quick-links small{display:block;opacity:.85}
    /* åº§ä½åœ–å­—ç½®ä¸­ */
    .quick-links a.seat-link{text-align:center}

    /* æœå°‹æŒ‰éˆ•ï¼šæ¼¸å±¤é’è‰² */
    button.primary{background:var(--btn-grad);border:0;color:#0b0c10;font-weight:900;letter-spacing:.2px}
    button.primary:hover{filter:saturate(1.08);}

    .preview{margin-top:8px;display:flex;gap:10px;flex-wrap:wrap}
    .preview img{max-height:86px;border-radius:8px;border:1px solid #2b3244}
    /* æ–°å¢ï¼šé¦–é ä¸è¦é¡¯ç¤ºåº•åœ–ç¸®åœ– */
    #bgPreview{display:none !important;}

    .result-head{font-size:13px;color:var(--muted);margin:10px 2px 6px}

    /* çµæœåˆ—è¡¨ */
    .grid{display:flex;flex-direction:column;gap:6px}
    .person{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;display:grid;grid-template-columns:1fr;gap:6px;overflow:hidden}
    .line{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:nowrap}
    .left,.right{display:flex;gap:10px;align-items:center;min-width:0}

    /* ç¬¬ä¸€è¡Œï¼šæ—— / åœ‹å®¶ / å§“å / IG */
    .namebar{display:flex;align-items:center;gap:8px;min-width:0}
    .namebar .flag{font-size:18px;line-height:1;flex:0 0 auto}
    .namebar .country{flex:0 0 8px;max-width:8px;overflow:hidden;white-space:nowrap;opacity:0.6}
    .namebar .personN{color:#fff;font-weight:900;font-size:15px;flex:1 1 auto;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .namebar .ig{color:#aeb7c2;font-size:13px;text-align:right;flex:0 1 38%;max-width:40%;min-width:56px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    @media (min-width:861px){
      .namebar .personN,.namebar .ig{
        color:#aeb7c2;font-size:13px;text-align:right;flex:0 1 38%;max-width:40%;min-width:56px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
      }
    }
    @media (max-width:420px){
      .namebar .personN{color:#fff;font-weight:900;font-size:15px;flex:1 1 auto;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
      .namebar .ig{color:#aeb7c2;font-size:13px;text-align:right;flex:0 1 38%;max-width:40%;min-width:56px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    }

    /* === ç‹€æ…‹å¾½ç« ï¼ˆåšå¤–åœˆï¼‹æ·±è‰²å…§å¿ƒï¼‹ç™½è‰²ç¬¦è™Ÿï¼›é«˜ç´šæ„Ÿï¼‰ === */
    .status{display:inline-flex;align-items:center;gap:8px}
    .badge{position:relative;width:22px;height:22px;display:grid;place-items:center;filter:drop-shadow(0 1px 2px rgba(0,0,0,.45))}
    .badge svg{width:22px;height:22px;display:block}
    .badge.ok{color:var(--ok)} .badge.warn{color:var(--warn)} .badge.bad{color:var(--bad)}
    .badge .ring{fill:#0f1117;stroke:currentColor;stroke-width:2.6}
    .badge .glyph{stroke:#fff;stroke-width:1.9;stroke-linecap:round;stroke-linejoin:round;fill:none}
    .badge .glyph-text{fill:#fff;font-size:12px;font-family:ui-sans-serif,system-ui;dominant-baseline:middle;text-anchor:middle}
    .status-label{display:flex;flex-direction:column;line-height:1.05}
    .status-label .zh{font-size:12px}
    .status-label .en{font-size:11px;opacity:.9}

    /* ã€Œé–‹å•Ÿé€£çµã€ï¼šç„¡å¤–æ¡†ã€è¢å…‰é¢¨ã€å°å°ºå¯¸ */
    .link-btn{padding:6px 9px;border-radius:10px;border:none;background:rgba(0,255,209,.08);
      box-shadow:0 0 0 1px rgba(0,255,209,.25),0 0 18px rgba(0,255,209,.18) inset,0 0 20px rgba(0,255,209,.15);
      color:#e5e7eb;font-size:12px;font-weight:700}
    .link-btn:hover{box-shadow:0 0 0 1px rgba(0,255,209,.4),0 0 26px rgba(0,255,209,.25) inset,0 0 26px rgba(0,255,209,.22)}

    /* ç¢ºèªï¼ä¸‹è¼‰ï¼šæ›´å°ã€å…©è¡Œ */
    .actions{display:flex;gap:10px;justify-content:space-between}
    .btn{padding:6px 9px;border-radius:12px;border:1px solid #2b3244;background:#0f1117;color:#e5e7eb;cursor:pointer;font-size:12.5px}
    .btn:hover{border-image:var(--rainbow) 1;border-width:1px;border-style:solid}
    .btn .zh{display:block;font-weight:800}
    .btn .en{display:block;font-size:11px;opacity:.9;font-weight:700}

    /* Toast */
    .toast{position:fixed;left:50%;bottom:14px;transform:translateX(-50%);background:#0f1117;border:1px solid #2b3244;
      color:#e5e7eb;padding:8px 12px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.45);opacity:0;transition:opacity .25s;z-index:60}
    .toast.show{opacity:1}

    /* Modal */
    .backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:50}
    .modal{width:min(640px,92vw);background:#0f1117;border-radius:16px;border:1px solid #2b3244;padding:14px;box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .modal .title2{margin:0 0 10px;font-size:18px;font-weight:800}
    .modal .rb{height:2px;background:var(--rainbow);opacity:.5;border-radius:2px;margin-bottom:10px}
    .opts{display:flex;gap:10px;flex-wrap:wrap;margin:6px 0 8px}
    .opt{flex:1;min-width:240px;padding:10px 12px;border-radius:12px;border:1px dashed #2b3244;background:#0f1117;color:#9aa4af;cursor:pointer;text-align:center;font-weight:800}
    .opt.active{color:#0b0c10;background:linear-gradient(90deg,#a7f3d0,#93c5fd);border:0}
    textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #2b3244;background:#0f1117;color:#e5e7eb;min-height:90px}
    .modal .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
    .btn-line{border:1px solid #2b3244;background:#0f1117;color:#e5e7eb}
    .btn-fill{background:transparent;border:1px solid transparent;border-image:var(--rainbow) 1;font-weight:900}

    /* æ‰‹æ©Ÿå¾®ç¸®èˆ‡ IG è‡ªå‹•æ›è¡Œï¼ˆå¿…è¦æ™‚æ‰çœç•¥ï¼‰ */
    @media (max-width:860px){
      .row{grid-template-columns:1fr}
      .actions{justify-content:space-between}
      .namebar .personN,.namebar .ig{
        color:#aeb7c2;font-size:13px;text-align:right;flex:0 1 38%;max-width:40%;min-width:56px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
      }
      /* ç¸®å° RAKU é«˜åº¦é¿å…æ“‹ä½å…§å®¹ */
      .cat-btn img.upload-icon{height:64px !important}
    }
    @media (max-width:420px){
      .tl .t1{font-size:24px}
      .tl .t2{font-size:18px}
      .tl .t3{font-size:14px}
      .btn{font-size:12px}
      .cat-btn img.upload-icon{height:56px !important}
    }

    /* When a .line has only one child, don't spread space */
    .line{justify-content:space-between}
    .line:has(> :only-child){justify-content:flex-start}

    /* === SAFE OVERRIDES (do not touch JS) === */
    .person > .line:first-of-type{justify-content:flex-start;width:100%}
    .person > .line:first-of-type > .left.namebar{flex:1 1 auto;width:100%}

    /* Loading spinnerï¼ˆå°¾å·´è½‰åœˆï¼‰ */
    .spinner{
      display:inline-block;width:14px;height:14px;margin-left:8px;vertical-align:-2px;
      border:2px solid rgba(255,255,255,.18);border-top-color:#a7f3d0;border-radius:50%;
      animation:spin 0.9s linear infinite; box-shadow:0 0 10px rgba(167,243,208,.35)
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* === ç‹€æ…‹æ–‡å­—å½©è‰²å…‰æšˆï¼ˆä»˜æ¬¾ç‰ˆï¼‰ === */
    .status .badge.warn + .status-label .zh, .status .badge.warn + .status-label .en{
      text-shadow:0 0 6px rgba(245,158,11,.65), 0 0 12px rgba(245,158,11,.35);
    }
    .status .badge.ok + .status-label .zh, .status .badge.ok + .status-label .en{
      text-shadow:0 0 6px rgba(34,197,94,.60), 0 0 12px rgba(34,197,94,.30);
    }
    .status .badge.bad + .status-label .zh, .status .badge.bad + .status-label .en{
      text-shadow:0 0 6px rgba(239,68,68,.60), 0 0 12px rgba(239,68,68,.30);
    }

    /* name èˆ‡ IG é‡‘è‰²ï¼ˆè¦†è“‹ï¼‰ */
    .namebar .personN, .namebar .ig{
      background: linear-gradient(180deg, #EAD28A 0%, #D9B550 35%, #B98A32 70%, #7A6027 100%);
      -webkit-background-clip: text; background-clip: text; color: transparent !important; font-weight: 900 !important;
    }

    /* ===== Overrides for status colors, buttons, and link button ===== */
    .status .badge.ok + .status-label .zh, .status .badge.ok + .status-label .en{
      color:#47D45A !important; font-weight:900 !important; text-shadow:0 0 6px rgba(71,212,90,.65) !important;
    }
    .status .badge.warn + .status-label .zh, .status .badge.warn + .status-label .en{
      color:#FFC000 !é‡è¦; font-weight:900 !important; text-shadow:0 0 6px rgba(255,192,0,.6) !é‡è¦;
    }
    .status .badge.bad + .status-label .zh, .status .badge.bad + .status-label .en{
      color:#C00000 !é‡è¦; font-weight:900 !important; text-shadow:0 0 6px rgba(192,0,0,.6) !é‡è¦;
    }

    .actions .btn{
      border: none !important; background: rgba(0,255,209,.08) !important;
      box-shadow: 0 0 0 1px rgba(0,255,209,.25), 0 0 18px rgba(0,255,209,.18) inset, 0 0 20px rgba(0,255,209,.15) !important;
      color: #e5e7eb !important; font-weight: 800 !important; padding: 6px 9px; border-radius: 10px;
    }
    .actions .btn:hover{
      background: rgba(0,255,209,.08) !important;
      box-shadow: 0 0 0 1px rgba(0,255,209,.35), 0 0 22px rgba(0,255,209,.22) inset, 0 0 24px rgba(0,255,209,.20) !important;
      border: 1px solid transparent !important; border-image: var(--rainbow) 1 !important;
    }
    .link-btn{ background: transparent !important; box-shadow: none !important; border: none !important; color: #00FFD1 !é‡è¦; text-decoration: underline !é‡è¦; padding: 0 !important; border-radius: 0 !important; font-weight: 800 !important; }
    .link-btn:hover{ text-decoration: underline !important; box-shadow: none !important; border: none !important; }

    .actions .btn{ padding: 4px 8px !important; border-radius: 9px !important; font-size: 11.5px !important; line-height: 1.2 !important; }
    .actions .btn .zh{ font-size: 11.5px !important; }
    .actions .btn .en{ font-size: 10px !important; }

    /* === ç‹€æ…‹çµ±è¨ˆåˆ—ï¼ˆé¦–é ï¼‰ === */
    .stats{display:flex;gap:10px;flex-wrap:wrap;margin:8px 0 10px}
    .stats .chip{display:flex;align-items:center;gap:8px;background:#0f1117;border:1px solid #2b3244;border-radius:999px;padding:6px 10px}
    .stats .chip .dot{width:8px;height:8px;border-radius:50%;display:inline-block}
    .stats .chip.ok .dot{background:#22c55e}
    .stats .chip.warn .dot{background:#f59e0b}
    .stats .chip.bad .dot{background:#ef4444}
    .stats .chip .lab{font-size:12px;color:#aeb7c2}
    .stats .chip .num{font-size:13px;color:#fff;min-width:14px;text-align:right}

    /* IG é€£çµï¼šä½¿ç”¨ SVG åœ–ç¤º */
    .ig-link{display:inline-flex;align-items:center;gap:6px;padding:4px 6px;border-radius:8px;color:#E1306C}
    .ig-link svg{width:16px;height:16px;display:block}
    .ig-link:hover{background:linear-gradient(90deg, rgba(255,192,203,.25), rgba(255,105,180,.25));box-shadow:0 0 6px rgba(255,182,193,.4), inset 0 0 4px rgba(255,182,193,.2)}

    /* ===== IG åœ–ç¤ºæŒ‰éˆ• ===== */
    .link-btn.ig-btn{
      position: relative !important; display: inline-grid !important; place-items: center !important;
      width: 28px !important; height: 28px !important; padding: 0 !é‡è¦; border: none !important;
      background: transparent !important; text-decoration: none !important; border-radius: 8px !é‡è¦;
    }
    .link-btn.ig-btn::before{
      content: "" !important; position: absolute !important; inset: -4px !important; border-radius: 12px !é‡è¦;
      background: conic-gradient(#ff5f6d,#ffc371,#9be15d,#00e3ae,#45aaf2,#9b59b6,#ff5f6d) !é‡è¦;
      filter: blur(7px) !é‡è¦; opacity: .9 !é‡è¦; z-index: -1 !é‡è¦;
    }
    .link-btn.ig-btn:hover{ transform: translateZ(0) scale(1.03) !important; }
    .link-btn.ig-btn img.ig-icon{ width: 24px !important; height: 24px !important; display: block !important; border-radius: 6px !é‡è¦; box-shadow: 0 0 0 1px rgba(255,255,255,.08) inset !important; }

    /* === RAKU ä¸Šå‚³æŒ‰éˆ•ä½¿ç”¨åŸ .cat-btn æ¨£å¼ï¼Œæ”¹ç‚ºé¡¯ç¤ºå®Œæ•´ PNG === */
    .cat-btn{ width:auto !important; height:auto !important; border-radius:0 !important; background:transparent !important; border:none !é‡è¦; padding:0 !important; overflow:visible !important; cursor:pointer; }
    .cat-btn img.upload-icon{ width:auto !important; height:80px !important; object-fit:contain !important; display:block !important; border-radius:0 !important; }

    /* === ç´”æ¼¸å±¤é‡‘è‰²ç‰ˆæœ¬ï¼ˆç„¡æé‚Šï¼Œä¹¾æ·¨äº®é‡‘ï¼‰ === */
    .namebar .personN{
      font-family: 'Montserrat', 'Helvetica Neue', 'Arial', sans-serif !important;
      background: linear-gradient(180deg, #EAD28A 0%, #D9B550 35%, #B98A32 70%, #7A6027 100%) !important;
      -webkit-background-clip: text !important; background-clip: text !important; color: transparent !important;
      text-align: center !important; font-weight: 900 !important;
    }
    /* IGï¼šå·¦å°é½Š + éŠ€ç°è‰²ï¼ˆä¿ç•™ç°¡æ½”ï¼‰ */
    .namebar .ig{ background: none !important; color: #BFC5C9 !important; text-align: left !é‡è¦; }

    /* === æ–°å¢ï¼šè®“ã€Œæ¡Œè™Ÿã€ç”¨èˆ‡ name ç›¸åŒçš„é‡‘è‰²æ¨£å¼ï¼ˆä¿æŒå°ºå¯¸ä¸€è‡´ï¼‰ === */
    .headName{
      font-family: 'Montserrat', 'Helvetica Neue', 'Arial', sans-serif !important;
      background: none !important; -webkit-background-clip: initial !important; background-clip: initial !é‡è¦;
      color: #FFD400 !important; font-weight: 900 !important; font-size: 15px !important; vertical-align: baseline;
    }
    .headSep{opacity:.45;margin:0 6px}
    /* æ‰‹æ©Ÿï¼šæ¡Œè™Ÿæ–·è¡Œï¼ˆéš±è—åˆ†éš”ç¬¦ä¸¦å¼·åˆ¶æ›è¡Œï¼‰ */
    @media (max-width:420px){
      .headSep{
        display:block !important; margin:4px 0 0 !important; height:0 !important; line-height:0 !important; font-size:0 !important; opacity:0 !é‡è¦;
      }
    }

    /* === ğŸ”¹ æ–°å¢ï¼šæŠŠã€Œå·²/æœªä»˜æ¬¾ã€èˆ‡ã€Œå°è¦½/åº§ä½åœ–ã€æ”¾åˆ°åŒä¸€æ°´å¹³åˆ—ï¼ˆç§»å…¥å‡çµçª—æ ¼ï¼‰ === */
    .top-row{
      display:flex; align-items:center; justify-content:space-between; gap:12px; margin:4px 0; /* æ›´ç·Šæ¹Š */
      flex-wrap:wrap;
    }
    .top-row .stats{margin:0}
    .top-row .quick-links{margin:0}
  </style>
</head>
<body>

  <!-- === å‡çµçª—æ ¼ï¼ˆä¸Šæ–¹å›ºå®šï¼šä¸‰è¡Œæ¨™é¡Œï¼‹å³ä¸Š RAKU ï¼‹ å½©è™¹åº•ç·šï¼‹ä»˜æ¬¾ç¸½è¦½/åº§ä½è¡¨ï¼‰ === -->
  <div class="freeze-pane" aria-label="frozen top">
    <div class="freeze-inner">
      <!-- ä¸‰è¡Œæ¨™é¡Œï¼ˆç™½å­—ï¼‹å…‰æšˆï¼‰ -->
      <div class="title tl">
        <div class="t1">Taiwan Pride ğŸŒˆ</div>
        <div class="t2">Reservation Confirmation</div>
        <div class="t3">10/24 é€±äº”æ™šé¤åå–®</div>
      </div>

      <!-- RAKU è²“èˆ‡å½©è™¹åº•ç·šï¼šè®“è²“ååœ¨ç·šä¸Šï¼ˆæœ€å³å´ï¼‰ -->
      <div class="raku-holder">
        <div class="raku-right">
          <div id="btnUploadBG" class="cat-btn" title="ä¸Šå‚³é‚€è«‹å¡åº•åœ– Upload invitation background">
            <img src="RAKU.png" alt="Upload background" class="upload-icon">
          </div>
        </div>
        <div class="rainbow-line"></div>
      </div>

      <!-- ğŸ”¹ ç·Šè²¼å½©è™¹ç·šä¸‹æ–¹ï¼šä»˜æ¬¾ç‹€æ…‹ç¸½è¦½ + å°è¦½/åº§ä½è¡¨ï¼ˆä¸€èµ·å›ºå®šï¼‰ -->
      <div class="top-row" aria-label="stats and quick links row">
        <div id="stats" class="stats" aria-label="status summary">
          <div class="chip ok"><span class="dot"></span><span class="lab">å·²ä»˜æ¬¾</span><b class="num" id="statOk">0</b></div>
          <div class="chip bad"><span class="dot"></span><span class="lab">æœªä»˜æ¬¾</span><b class="num" id="statBad">0</b></div>
        </div>
        <div class="quick-links" aria-label="quick links">
          <a id="guideLink" href="#">å°è¦½<br><small>Guide</small></a>
          <a id="seatLink" class="seat-link" href="#">åº§ä½åœ–<br><small>Seating Map</small></a>
        </div>
      </div>
    </div>
  </div>

  <!-- å…§å®¹å¾é€™è£¡é–‹å§‹æ»¾å‹•ï¼ˆå§“åæœå°‹ä»¥ä¸‹ï¼‰ -->
  <div class="wrap">
    <div class="card">
      <!-- æœå°‹åˆ— -->
      <div class="row">
        <div class="input-wrap">
          <label>å§“å / NAME</label>
          <input id="nameInput" list="nameList" placeholder="è¼¸å…¥æˆ–é¸æ“‡å§“å / Type or choose a name" />
          <datalist id="nameList"></datalist>
        </div>
        <div class="input-wrap">
          <label>IG å¸³è™Ÿ / IG</label>
          <input id="igInput" list="igList" placeholder="è¼¸å…¥æˆ–é¸æ“‡ IG / Type or choose IG" />
          <datalist id="igList"></datalist>
        </div>
        <div class="input-wrap">
          <button id="searchBtn" class="primary">æœå°‹ / Search</button>
        </div>
      </div>

      <!-- åº•åœ–é è¦½ï¼ˆéš±è—é¡¯ç¤ºï¼Œä½†ä»ä¿ç•™ç¯€é»ï¼‰ -->
      <div id="bgPreview" class="preview" aria-label="invitation previews"></div>

      <div id="head" class="result-head">
        è³‡æ–™è¼‰å…¥ä¸­â€¦ / Loading rosterâ€¦
        <span class="spinner" aria-hidden="true"></span>
      </div>

      <div id="grid" class="grid"></div>
    </div>
  </div>

  <!-- éš±è— inputï¼ˆåªå‰©åº•åœ–ï¼‰ -->
  <input id="fileBG" type="file" accept="image/*" style="display:none" />

  <!-- Confirm Modalï¼ˆä¿ç•™åŸæ©Ÿåˆ¶ï¼‰ -->
  <div id="confirmBackdrop" class="backdrop">
    <div class="modal">
      <div class="title2">å‡ºå¸­ç¢ºèª / Attendance Confirmation</div>
      <div class="rb"></div>
      <div class="opts">
        <div class="opt" data-val="confirmed">ç¢ºèªè¨‚ä½ï¼Œæˆ‘æœƒåƒåŠ <br>Confirm reservation</div>
        <div class="opt" data-val="cancelled">æŠ±æ­‰ï¼Œç„¡æ³•åƒåŠ <br>Sorry - cannot attend</div>
      </div>
      <div class="input-wrap"><label>å‚™è¨» / Notes</label><textarea id="noteArea" placeholder="å¯«é»æƒ³èªªçš„è©± / Leave a note"></textarea></div>
      <div class="actions">
        <button id="confirmCancel" class="btn btn-line"><span class="zh">å–æ¶ˆ</span><span class="en">Cancel</span></button>
        <button id="confirmSubmit" class="btn btn-fill"><span class="zh">é€å‡º</span><span class="en">Submit</span></button>
      </div>
    </div>
  </div>

  <!-- é‚€è«‹å‡½é è¦½ Modalï¼ˆæŒ‰éˆ•æ–‡æ¡ˆå·²æ”¹æˆ download/closeï¼‰ -->
  <div id="previewBackdrop" class="backdrop">
    <div class="modal" style="width:min(860px,96vw);">
      <div class="title2" id="previewTitle">é‚€è«‹å‡½é è¦½ / Invite Preview</div>
      <div class="rb"></div>
      <div style="max-height:70vh;overflow:auto;display:grid;place-items:center;padding:6px;">
        <img id="invitePreviewImg" alt="Invite preview" style="max-width:100%; max-height:68vh; height:auto; object-fit:contain; border-radius:12px; border:1px solid #2b3244"/>
      </div>
      <div class="actions">
        <a id="btnDownloadPNG" class="btn btn-fill" href="#" download="invite.png"> download </a>
        <button id="previewClose" class="btn btn-line">close</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <script>
    /* ========== (1) è¨­å®šï¼šæŠŠé€™è£¡æ›æˆä½ çš„ GAS URL ========== */
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxJdToNoRIc2q5-jT53c6jwcD6WNNDbNOBmhqE2ulDLmNDsBDo86hCVqj32AI9Fp53n/exec';
    const PASSWORD = '0714'; // ä¸Šå‚³åº•åœ–ä¿è­·ç”¨ï¼ˆåƒ… promptï¼‰

    /* ========== (2) ç‹€æ…‹ ========== */
    const state = {
      rows: [], // é›²ç«¯ roster
      bgImages: [], // é‚€è«‹å¡åº•åœ–ï¼ˆè‡ªå‹•è¼‰å…¥ card.* æˆ–æ‰‹å‹•ä¸Šå‚³ï¼‰
      selected: null, // æ­£åœ¨ confirm çš„äºº
      confirmChoice: null
    };

    /* ========== (3) å°å·¥å…· ========== */
    const $ = (id)=>document.getElementById(id);
    const showToast = (msg)=>{
      const t=$('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1500)
    };
    const norm = (s)=> (s||'').toString().trim().toLowerCase();
    const unique = (arr)=>[...new Set(arr)];
    const by = (k)=>(a,b)=> (a[k]||'').localeCompare(b[k]||'');

    /* ç°¡æ˜“åˆ‡æ› head è¼‰å…¥ä¸­æ¨£å¼ï¼ˆå°¾å·´è½‰åœˆï¼‰ */
    function setHeadLoading(isLoading){
      const head = $('head'); if(!head) return;
      if(isLoading){
        head.innerHTML = 'è³‡æ–™è¼‰å…¥ä¸­â€¦ / Loading rosterâ€¦ <span class="spinner" aria-hidden="true"></span>';
      }else{
        head.textContent = 'è«‹æ–¼ä¸Šæ–¹è¼¸å…¥ã€Œå§“åæˆ– IGã€å¾Œæœå°‹ / Type NAME or IG to search';
      }
    }

    /* ========== (4) è®€é›²ç«¯åå–®ï¼ˆGASï¼‰ ========== */
    async function fetchRoster(){
      try{
        if(!WEB_APP_URL){ $('head').textContent='å°šæœªè¨­å®šè³‡æ–™ç«¯é» / No WEB_APP_URL'; return; }
        setHeadLoading(true);
        const res = await fetch(WEB_APP_URL + '?mode=roster', { method:'GET', cache:'no-store' });
        if(!res.ok) throw new Error('network');
        const data = await res.json();
        state.rows = Array.isArray(data) ? data : (data.rows || []);
        rebuildDatalists(); renderStats(); setHeadLoading(false);
      }catch(e){
        console.error(e);
        $('head').textContent = 'åå–®è¼‰å…¥å¤±æ•— / Failed to load roster';
      }
    }
    function rebuildDatalists(){
      const dlN = $('nameList'); const dlI = $('igList');
      dlN.innerHTML = ''; dlI.innerHTML = '';
      unique(state.rows.map(r=>r.name).filter(Boolean).sort()).forEach(v=>{
        const o=document.createElement('option'); o.value=v; dlN.appendChild(o);
      });
      unique(state.rows.map(r=>r.ig).filter(Boolean).sort()).forEach(v=>{
        const o=document.createElement('option'); o.value=v; dlI.appendChild(o);
      });
    }

    /* ========== (4.5) åŒè³‡æ–™å¤¾è‡ªå‹•è¼‰å…¥ card.* ä½œç‚ºåº•åœ–ï¼ˆé †åºå˜—è©¦ï¼‰ ========== */
    async function tryLoadCardBackgrounds(){
      const candidates = ['card6.png','card.jpg','card.jpeg','card.webp','card.svg'];
      for(const name of candidates){
        try{
          const img = await loadImageRelative(name);
          state.bgImages = [img]; renderBGPreview(); showToast('å·²è‡ªå‹•è¼‰å…¥ card åº•åœ–');
          return;
        }catch(_){}
      }
      // è‹¥æ²’æœ‰ card.*ï¼Œä¿æŒå¾…ä¸Šå‚³
    }
    function loadImageRelative(src){
      return new Promise((resolve,reject)=>{
        const img = new Image();
        img.onload = ()=> resolve(img);
        img.onerror = ()=> reject(new Error('not found'));
        img.src = src; // èˆ‡æœ¬é åŒè³‡æ–™å¤¾
      });
    }

    /* ========== (5) ä¸Šå‚³é‚€è«‹å¡åº•åœ–ï¼ˆåªæœ‰é€™å€‹éœ€è¦å¯†ç¢¼ï¼‰ ========== */
    document.getElementById('btnUploadBG').addEventListener('click', ()=>{
      const p = prompt('è«‹è¼¸å…¥å¯†ç¢¼ / Enter password'); if(p===null) return;
      if(p!==PASSWORD){ showToast('å¯†ç¢¼éŒ¯èª¤ / Wrong password'); return; }
      document.getElementById('fileBG').click();
    });
    document.getElementById('fileBG').addEventListener('change', async (e)=>{
      const files = Array.from(e.target.files||[]); if(!files.length) return;
      state.bgImages = [];
      for(const f of files){ const img = await fileToImage(f); state.bgImages.push(img); }
      renderBGPreview(); showToast('é‚€è«‹å‡½åº•åœ–å·²è¼‰å…¥ / Invitation background loaded');
      e.target.value='';
    });
    function fileToImage(file){
      return new Promise((res,rej)=>{
        const img=new Image(); img.onload=()=>res(img); img.onerror=rej; img.src=URL.createObjectURL(file);
      });
    }
    function renderBGPreview(){
      const box=$('bgPreview'); box.innerHTML='';
      state.bgImages.forEach(img=>{ const el=document.createElement('img'); el.src=img.src; box.appendChild(el); });
    }

    /* ========== (6) æœå°‹ ========== */
    document.getElementById('searchBtn').addEventListener('click', search);
    document.getElementById('nameInput').addEventListener('keydown',e=>{if(e.key==='Enter') search(); renderStats();});
    document.getElementById('igInput').addEventListener('keydown',e=>{if(e.key==='Enter') search(); renderStats();});
    function search(){
      const qn = norm(document.getElementById('nameInput').value);
      const qi = norm(document.getElementById('igInput').value);
      if(!state.rows.length){ showToast('é›²ç«¯åå–®å°šæœªå°±ç·’ / Roster not ready'); return; }
      let sel = null;
      if(qi) sel = state.rows.find(r=>norm(r.ig)===qi);
      if(!sel && qn) sel = state.rows.find(r=>norm(r.name)===qn);
      let rows=[]; let leader='';
      if(sel){
        leader = sel.leader;
        rows = state.rows.filter(r=>norm(r.leader)===norm(leader));
      }else{
        const cand = state.rows.filter(r=> (qi && norm(r.ig).includes(qi)) || (qn && norm(r.name).includes(qn)) );
        if(cand.length){
          leader = cand[0].leader;
          rows = state.rows.filter(r=>norm(r.leader)===norm(leader));
        }
      }
      renderList(rows, leader);
    }

    /* ========== (7) åˆ—è¡¨æ¸²æŸ“ï¼ˆä»˜æ¬¾ç‹€æ…‹æ–‡å­—ï¼‰ ========== */
    function renderList(rows, leader){
      const grid = document.getElementById('grid'); grid.innerHTML='';
      if(!rows || !rows.length){ document.getElementById('head').textContent='æŸ¥ç„¡è³‡æ–™ / No results'; return; }

      /* âŠ æ–°å¢ï¼šå–è©² Leader çš„æ¡Œè™Ÿï¼ˆä»¥ç¬¬ä¸€ç­†çš„ number æ¬„ä½ç‚ºæº–ï¼‰ */
      const tableNumber = (rows.find(r => r.number!=null && r.number!=='') || rows[0] || {}).number ?? '';

      /* â‹ æ–°å¢ï¼šåœ¨æ¨™é ­å³å´é¡¯ç¤ºã€Œæ¡Œè™Ÿ / table numberã€ï¼›å­—é«”æ¨£å¼åŒ name */
      document.getElementById('head').innerHTML = leader
        ? `æ¡Œé•· / Leaderï¼š<b class="rbtext">${leader||'â€”'}</b>ï¼ˆ${rows.length} ç­† / recordsï¼‰<span class="headSep">ï½œ</span>æ¡Œè™Ÿ / table numberï¼š<span class="headName">${tableNumber || 'â€”'}</span>`
        : `å…± ${rows.length} ç­† / records`;

      rows.sort((a,b)=> by('country')(a,b) || by('name')(a,b));
      for(const r of rows){ grid.appendChild(renderPerson(r)); }
    }

    function renderPerson(r){
      const card = document.createElement('div'); card.className='person';

      /* ç¬¬ä¸€è¡Œï¼šæ—— / åœ‹å®¶ / å§“å / IG */
      const L1 = document.createElement('div'); L1.className='line';
      const left1 = document.createElement('div'); left1.className='left namebar';
      const flag = document.createElement('div'); flag.className='flag'; flag.textContent = r.flag || 'â€”';
      const ctry = document.createElement('span'); ctry.className='country'; ctry.textContent = (r.country||'â€”');
      const personN = document.createElement('span'); personN.className='personN'; personN.textContent = (r.name||'â€”');
      const ig = document.createElement('span'); ig.className='ig'; ig.textContent = (r.ig||'â€”');
      left1.append(flag, ctry, personN, ig); L1.append(left1);

      /* ç¬¬äºŒè¡Œï¼ˆå·¦ï¼šä»˜æ¬¾ç‹€æ…‹ï¼›å³ï¼šé–‹å•Ÿé€£çµï¼‰ */
      const L2 = document.createElement('div'); L2.className='line';
      const left2 = document.createElement('div'); left2.className='left';
      left2.append(buildStatus(r.pay_status));
      const right2 = document.createElement('div'); right2.className='right';
      if(r.link){
        const a=document.createElement('a'); a.href=r.link; a.target='_blank'; a.rel='noopener noreferrer'; a.className='link-btn ig-btn';
        const img=document.createElement('img'); img.src='pngsucai_1605688_ec16ce.png'; img.alt='Instagram'; img.className='ig-icon';
        a.appendChild(img); right2.appendChild(a);
      }
      L2.append(left2,right2);

      /* ç¬¬ä¸‰è¡Œï¼šConfirm / Downloadï¼ˆå°å°ºå¯¸ï¼‹ä¸­è‹±åˆ†è¡Œï¼‰ */
      const L3 = document.createElement('div'); L3.className='actions';
      const btnC = document.createElement('button'); btnC.className='btn'; btnC.innerHTML='<span class="zh">ç¢ºèª</span><span class="en">Confirm</span>'; btnC.addEventListener('click',()=> openConfirm(r));
      const btnD = document.createElement('button'); btnD.className='btn'; btnD.innerHTML='<span class="zh">é‚€è«‹å‡½ä¸‹è¼‰</span><span class="en">Download Invite</span>'; btnD.addEventListener('click',()=> downloadInvite(r));
      L3.append(btnC, btnD);

      card.append(L1,L2,L3); return card;
    }

    /* ===== ä»˜æ¬¾ç‹€æ…‹ï¼šåƒ…åˆ†ã€Œå·²ä»˜æ¬¾(ç¶ )ï¼æœªä»˜æ¬¾(ç´…)ã€ï¼Œä¾†æºç‚º pay_status ===== */
    function buildStatus(payStatus){
      const box=document.createElement('div'); box.className='status';
      const s = (payStatus||'').toString().trim().toLowerCase();
      const paidSet = new Set(['paid','pay','yes','y','true','1','å·²ä»˜æ¬¾','ä»˜æ¸…','å®Œæˆä»˜æ¬¾']);
      const isPaid = paidSet.has(s);
      const type = isPaid ? 'ok' : 'bad';
      const zh = isPaid ? 'å·²ä»˜æ¬¾' : 'æœªä»˜æ¬¾';
      const en = isPaid ? 'Paid' : 'Unpaid';
      const iconType = isPaid ? 'ok' : 'bad';
      const badge=document.createElement('div'); badge.className='badge '+type; badge.innerHTML = svgIcon(iconType);
      const lab=document.createElement('div'); lab.className='status-label'; lab.innerHTML = `<span class="zh">${zh}</span><span class="en">${en}</span>`;
      box.append(badge,lab); return box;
    }
    function svgIcon(kind){
      if(kind==='ok'){
        return `<svg viewBox="0 0 24 24" aria-hidden="true"><circle class="ring" cx="12" cy="12" r="10.5" /><path class="glyph" d="M7 12.5l3 3 6-6" /></svg>`;
      }
      return `<svg viewBox="0 0 24 24" aria-hidden="true"><circle class="ring" cx="12" cy="12" r="10.5" /><path class="glyph" d="M8 8l8 8M16 8l-8 8" /></svg>`;
    }

    /* ========== (8) Confirm Modalï¼ˆä¿ç•™åŸæµç¨‹ï¼‰ ========== */
    const modal=document.getElementById('confirmBackdrop');
    const noteArea=document.getElementById('noteArea');
    const btnSubmit=document.getElementById('confirmSubmit');
    document.querySelectorAll('.opt').forEach(el=> el.addEventListener('click',()=> selectOpt(el)) );
    document.getElementById('confirmCancel').addEventListener('click', ()=> closeModal());
    function openConfirm(person){
      state.selected = person; state.confirmChoice = null; noteArea.value='';
      document.querySelectorAll('.opt').forEach(o=>o.classList.remove('active')); modal.style.display='flex';
    }
    function selectOpt(el){
      document.querySelectorAll('.opt').forEach(o=>o.classList.remove('active'));
      el.classList.add('active'); state.confirmChoice = el.dataset.val;
    }
    function closeModal(){ modal.style.display='none'; }
    btnSubmit.addEventListener('click', async ()=>{
      if(!state.confirmChoice){ showToast('è«‹é¸æ“‡ä¸€å€‹é¸é … / Please choose an option'); return; }
      const person = state.selected; if(!person){ closeModal(); return; }
      const payload = {
        action:'updateStatus',
        item: person.item, number: person.number, country: person.country, flag: person.flag,
        name: person.name, ig: person.ig, leader: person.leader, link: person.link,
        status: state.confirmChoice, notes: noteArea.value.trim(), ts: Date.now()
      };
      btnSubmit.disabled=true; btnSubmit.textContent='å‚³é€ä¸­â€¦ / Sendingâ€¦';
      try{
        const res = await fetch(WEB_APP_URL, {
          method:'POST', headers:{'Content-Type':'text/plain;charset=utf-8'},
          body: JSON.stringify(payload), mode:'cors', cache:'no-store'
        });
        let ok=false; try{ const j=await res.json(); ok=!!j.ok || Array.isArray(j); }catch{ ok=res.ok; }
        if(!ok) throw new Error('SERVER_NOK');
        person.status = state.confirmChoice; showToast('å·²é€å‡ºä¸¦æ›´æ–°ç‹€æ…‹ / Submitted & updated');
        closeModal(); search(); renderStats();
      }catch(err){
        console.error(err); showToast('é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ / Failed to submit');
      }finally{
        btnSubmit.disabled=false; btnSubmit.textContent='é€å‡º / Submit';
      }
    });

    /* ========== (9) é‚€è«‹å¡ä¸‹è¼‰ï¼šæ–‡å­—æ”¹ç‚ºã€Œnumber - itemã€ ========== */
    async function downloadInvite(person){
      if(!state.bgImages.length){
        showToast('æ‰¾ä¸åˆ°é‚€è«‹å¡åº•åœ–ï¼Œè«‹æ”¾åŒè³‡æ–™å¤¾çš„ card.* æˆ–ç”¨ RAKU ä¸Šå‚³'); return;
      }
      const content = (person.qrcode || '').toString().trim();
      const numberText = (person.number || '').toString();
      const itemText = (person.item || '').toString();
      if(!content){ showToast('æ­¤åˆ—æ²’æœ‰ qrcode æ¬„ä½å…§å®¹'); return; }

      const bg = state.bgImages[0];
      const W = bg.naturalWidth || bg.width, H = bg.naturalHeight || bg.height;

      const canvas = document.createElement('canvas'); const ctx = canvas.getContext('2d');
      canvas.width = W; canvas.height = H;
      ctx.drawImage(bg,0,0,W,H);

      const margin = 0.08 * Math.min(W,H);
      const qrSize = Math.floor(0.22 * W);
      const textGap = qrSize / 3;
      const qrX = Math.floor((W - qrSize) / 2);
      const qrY = Math.floor(H - margin - qrSize - textGap);

      const encoded = encodeURIComponent(content);
      const apiURL = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize}x${qrSize}&ecc=M&data=${encoded}`;
      const qrImg = new Image(); qrImg.crossOrigin = 'anonymous';
      const loaded = new Promise((resolve,reject)=>{ qrImg.onload = resolve; qrImg.onerror = ()=> reject(new Error('QR API è¼‰å…¥å¤±æ•—')); });
      qrImg.src = apiURL;
      try{ await loaded; }catch(err){ console.error(err); showToast('QR ç”¢ç”Ÿå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦'); return; }

      ctx.drawImage(qrImg, qrX, qrY, qrSize, qrSize);

      const text = (numberText || '') + (itemText ? ' - ' + itemText : '');
      const fontSize = Math.max(10, Math.floor(qrSize * 0.25));
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      ctx.font = `600 ${fontSize}px "Harrington","Didot","Times New Roman",serif`;
      const textCX = qrX + qrSize/2; const textCY = qrY + qrSize + (qrSize/3);
      ctx.strokeText(text, textCX, textCY);
      ctx.fillStyle = '#000000';
      ctx.fillText(text, textCX, textCY);

      try {
        const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
        if (!blob) throw new Error('TO_BLOB_FAILED');
        const url = URL.createObjectURL(blob);
        const img = document.getElementById('invitePreviewImg');
        const dl = document.getElementById('btnDownloadPNG');
        const title = document.getElementById('previewTitle');
        img.src = url;
        const safeName = (person.name||'guest').replace(/[^\w\u4e00-\u9fa5-]+/g,'_');
        dl.download = `invite_${person.number||''}_${safeName}.png`;
        dl.href = url;
        if(title) title.textContent = 'é‚€è«‹å‡½é è¦½ / Invite Preview';
        dl.onclick = () => setTimeout(()=> URL.revokeObjectURL(url), 4000);
        openPreview();
      } catch (e) {
        console.error(e); showToast('ç”¢ç”Ÿä¸‹è¼‰é€£çµå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
      }
    }

    /* === ç”¨æ–¼å°è¦½ï¼åº§ä½åœ–ï¼šé–‹å•Ÿæœ¬åœ°åœ–ç‰‡çš„æ‡¸æµ®è¦–çª—é è¦½èˆ‡ä¸‹è¼‰ === */
    function openStaticImage(path, downloadName, titleText){
      const img = document.getElementById('invitePreviewImg');
      const dl = document.getElementById('btnDownloadPNG');
      const title = document.getElementById('previewTitle');
      img.src = path; dl.href = path; dl.download = downloadName;
      if(title) title.textContent = titleText;
      openPreview();
    }

    /* === é è¦½å½ˆçª—æ§åˆ¶ === */
    const previewBackdrop = document.getElementById('previewBackdrop');
    document.getElementById('previewClose').addEventListener('click', ()=>{ previewBackdrop.style.display='none'; });
    function openPreview(){ previewBackdrop.style.display='flex'; }

    /* ========== (10) å•Ÿå‹• ========== */
    function init(){
      fetchRoster();
      tryLoadCardBackgrounds();

      const guide = document.getElementById('guideLink');
      const seat = document.getElementById('seatLink');
      if(guide){ guide.addEventListener('click', (e)=>{ e.preventDefault(); openStaticImage('pic1.jpg','guide.png','å°è¦½ / Guide'); }); }
      if(seat){ seat.addEventListener('click', (e)=>{ e.preventDefault(); openStaticImage('pic2.jpg','seating.png','åº§ä½åœ– / Seating Map'); }); }
    }
    init();

    /* ===== çµ±è¨ˆæ”¹ç‚ºä»˜æ¬¾èªæ„ï¼šPaid / Unpaidï¼ˆä¾†æº pay_statusï¼‰ ===== */
    function renderStats(){
      const paidSet = new Set(['paid','pay','yes','y','true','1','å·²ä»˜æ¬¾','ä»˜æ¸…','å®Œæˆä»˜æ¬¾']);
      const paid = state.rows.filter(r => paidSet.has((r.pay_status||'').toString().trim().toLowerCase())).length;
      const unpaid = state.rows.length - paid;
      const elOk = document.getElementById('statOk');
      const elBad = document.getElementById('statBad');
      if(elOk) elOk.textContent = paid; // å·²ä»˜æ¬¾
      if(elBad) elBad.textContent = unpaid; // æœªä»˜æ¬¾
    }
  </script>
</body>
</html>
